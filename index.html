<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Talentos Tech</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./src/css/topbar.css" />
    <link rel="stylesheet" href="./src/css/footer.css" />
    <link rel="stylesheet" href="./src/css/home.css" />
    <link rel="stylesheet" href="./src/css/style.css" />
    <link rel="stylesheet" href="./src/css/listagem-talentos.css" />
    <script src="https://unpkg.com/lucide@latest"></script>
  </head>
  <body>
    <main class="home">
      <div class="container">
        <h1>
          Encontre ou torne-se o
          <span class="gradient-text">talento que <br />impulsiona</span>
          a inovação tecnológica
        </h1>
        <p class="subtext">
          Conecte-se com talentos especializados para orientação estratégica e
          técnica em projetos inovadores e<br/> acelere seu crescimento no ecossistema
          de tecnologia.
        </p>

        <section class="rede-numeros">
          <div class="card-nuvem">
            <h2>Áreas de Atuação</h2>
            <div class="areas-grid" id="areas-grid">
              <!-- Áreas serão inseridas aqui dinamicamente -->
            </div>
          </div>

          <div class="cards-destaque">
            <div class="card-info purple">
              <div>
                <strong id="total-talentos">0</strong>
                <p>Talentos Cadastrados</p>
              </div>
              <i data-lucide="users"></i>
            </div>
            <div class="card-info blue">
              <div>
                <strong id="total-areas">0</strong>
                <p>Áreas de Atuação</p>
              </div>
              <i data-lucide="rocket"></i>
            </div>
          </div>
        </section>
      </div>

      <section class="talentos-container container">
        <h1>Encontre seu <span class="gradient-text">Talento Ideal</span></h1>
        <p class="subtext">
          Navegue pelos nossos talentos qualificados e encontre o especialista
          perfeito para acelerar seu projeto de inovação
        </p>

        <div class="filtros-tags" id="filtros-tags"></div>
        <div class="grid-talentos" id="grid-talentos"></div>
      </section>
    </main>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/src/js/suppabase-api.js"></script>
    <script src="/src/js/footer.js"></script>
    <script src="/src/js/topbar.js"></script>


    <!-- JS com renderização de filtros + cards -->
    <script type="module">
      import { renderizarTalentos } from '/src/js/lista-talentos.js';
    
      renderizarTalentos({
        containerId: "grid-talentos",
        filtrosId: "filtros-tags",
        exibirAcoes: false
      });
    
      const filtros = document.getElementById("filtros-tags");
      const grid = document.querySelector(".grid-talentos");
      const areasGrid = document.getElementById("areas-grid");
    
      let areasMap = {};
      let talentosCache = [];
    
      async function carregarNuvemAreas() {
        try {
          const areas = await window.supabaseApi.getAll("atuacao");
          areasGrid.innerHTML = "";
    
          areas.forEach((area) => {
            const span = document.createElement("span");
            span.classList.add("area");
            span.textContent = area.nome;
            areasGrid.appendChild(span);
          });
    
          // Atualiza o contador de áreas, se existir
          const totalAreas = document.getElementById("total-areas");
          if (totalAreas) totalAreas.textContent = areas.length;
        } catch (error) {
          console.error("Erro ao carregar nuvem de áreas:", error);
        }
      }
    
      async function carregarAreas() {
        const areas = await window.supabaseApi.getAll("atuacao");
        filtros.innerHTML = "";
    
        areasMap = areas.reduce((map, area) => {
          map[area.id] = area.nome;
          return map;
        }, {});
    
        areas.forEach((area) => {
          const span = document.createElement("span");
          span.textContent = area.nome;
          span.classList.add("filtro-tag");
          span.addEventListener("click", () => filtrarPorArea(area.id, span));
          filtros.appendChild(span);
        });
      }
    
      function filtrarPorArea(areaId, selectedTag) {
        document.querySelectorAll(".filtro-tag").forEach(tag => {
          tag.classList.remove("ativo");
        });
        selectedTag.classList.add("ativo");
    
        const filtrados = talentosCache.filter(t => t.atuacao === areaId);
        renderizarTalentos({
          containerId: "grid-talentos",
          filtrosId: "filtros-tags",
          talentosExternos: filtrados,
          exibirAcoes: false
        });
      }
    
      carregarAreas();
      carregarNuvemAreas();
      lucide.createIcons();
    </script>
    
  </body>
</html>
